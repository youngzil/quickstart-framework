# 时间和时区详解

## 世界时区及国际换日线示意图

两地时间表简称为GMT或UTC，而世界时区表则通称为World Time



## 全球24个时区的划分

本初子午线：以英国伦敦格林威治这个地方为零度经线的起点（亦称为本初子午线），并以地球由西向东每24小时自转一周360°，订定每隔经度15°，时差1小时。而每15°的经线则称为该时区的中央经线，将全球划分为24个时区，其中包含23个整时区及180°经线左右两侧的2个半时区。

有的说东西第十二时区重合，也有说东西十二时区各占7.5°的

由于地球自西向东自转，就全球的时间来看，东经的时间比西经要早，东边的人先看到太阳升起

向东走，每经过一个时区，时钟就要+1小时（调快1个小时），向西边走，每经过一个时区，时钟就要-1小时（回拨1个小时），

经线180°被定为国际换日线，由西向东通过此线时日期要减去一日，反之，若由东向西则要增加一日。


全世界按经度划分为24个时区，每区经度15°，有零时区、东西各11个时区和12个时区。各时区使用其中央经线的地方平时为时区时间。

我们生活中采用的时间是东八区时间， 东八区（UTC / GMT+08:00）是比世界协调时间（UTC）/ 格林尼治标准时间（GMT）快8小时的时区，理论上的位置是位于东经112.5度至127.5度之间，是东盟标准的其中一个候选时区。

当格林尼治标准时间为0:00时，东八区的标准时间为08:00 ，也就北京时间。北京时间采用的是距离北京以东约340公里处的地方时间。北京时间使用东八区的区时，而非东八区由北京时间授时。北京时间是中国行政管理、生产、交通运输等工作的时间计量标准。





## 格林威治标准时间GMT

「格林威治标准时间」(Greenwich Mean Time，简称G.M.T.)

格林尼治标准时间（GMT）

十七世纪，格林威治皇家天文台为了海上霸权的扩张计画而进行天体观测。1675年旧皇家观测所(Old Royal Observatory) 正式成立，到了1884年决定以通过格林威治的子午线作为划分地球东西两半球的经度零度。观测所门口墙上有一个标志24小时的时钟，显示当下的时间，对全球而言，这里所设定的时间是世界时间参考点，全球都以格林威治的时间作为标准来设定时间，这就是我们耳熟能详的「格林威治标准时间」(Greenwich Mean Time，简称G.M.T.)的由来，标示在手表上，则代表此表具有两地时间功能，也就是同时可以显示原居地和另一个国度的时间。


GMT的正午是指当太阳横穿格林尼治子午线（本初子午线）时的时间。但由于地球自转不均匀不规则，导致GMT时间不精确，现在已经不再作为世界标准世界使用。



## 世界协调时间UTC

UTC指的是Coordinated Universal Time－ 世界协调时间（又称世界标准时间、世界统一时间）

多数的两地时间表都以GMT来表示，但也有些两地时间表上看不到GMT字样，出现的反而是UTC这3个英文字母，究竟何谓UTC？事实上，UTC指的是Coordinated Universal Time－ 世界协调时间（又称世界标准时间、世界统一时间），是经过平均太阳时(以格林威治时间GMT为准)、地轴运动修正后的新时标以及以「秒」为单位的国际原子时所综合精算而成的时间，计算过程相当严谨精密，因此若以「世界标准时间」的角度来说，UTC比GMT来得更加精准。其误差值必须保持在0.9秒以内，若大于0.9秒则由位于巴黎的国际地球自转事务中央局发布闰秒，使UTC与地球自转周期一致。所以基本上UTC的本质强调的是比GMT更为精确的世界时间标准，不过对于现行表款来说，GMT与UTC的功能与精确度是没有差别的。


UTC：全球标准时间(Coordinated Universal Time),由世界时间标准设定的时间，原先也被称为格林威治标准时间或者GMT。UTC+800：UTC是零时区，即格林威治标准时间；800的含义是8:00即8个小时0分；UTC+800是指比格林威治标准时间提前8个小时，应当是东八区的时间，也就是北京时间。08:59:58 UTC+800：当前时间是东八区（北京时间）08:59:58 （确切地说是东经120度经线上的时间）.


UTC，英文名 Coordinated Universal Time ，即协调世界时，UTC是以原子时秒长为基础，在时刻上尽量接近于GMT的一种时间计量系统。国际原子时的准确度为每日数纳秒，而世界时的准确度为每日数毫秒。对于这种情况，一种称为协调世界时的折衷时标于1972年面世。为确保UTC与GMT相差不会超过0.9秒，在有需要的情况下会在UTC内加上正或负闰秒。UTC现在作为世界标准时间使用。所以，UTC 与 GMT 基本上等同，误差不差过0.9秒。



## 夏令时（夏日节约时间DST）

「夏日节约时间」Daylight Saving Time（简称D.S.T.）

夏令时：在夏天加一个小时，注意南半球地区的夏季时间跟北半球相反。

所谓「夏日节约时间」Daylight Saving Time（简称D.S.T.），是指在夏天太阳升起的比较早时，将时钟拨快一小时，以提早日光的使用，在英国则称为夏令时间(Summer Time)。这个构想于1784年由美国班杰明·富兰克林提出来，1915年德国成为第一个正式实施夏令日光节约时间的国家，以削减灯光照明和耗电开支。自此以后，全球以欧洲和北美为主的约70个国家都引用这个做法。目前被划分成两个时区的印度也正在商讨是否全国该统一实行夏令日光节约时间。欧洲手机上也有很多GSM系统的基地台，除了会传送当地时间外也包括夏令日光节约时间，做为手机的时间标准，使用者可以自行决定要开启或关闭。值得注意的是，某些国家有实施「夏日节约时间」的制度，出国时别忘了跟随当地习惯在表上调整一下，这可是机械表没有的功能设计哦！




## CST时间

CST却同时可以代表如下 4 个不同的时区：

- Central Standard Time (USA) UT-6:00
- Central Standard Time (Australia) UT+9:30
- China Standard Time UT+8:00
- Cuba Standard Time UT-4:00

可见，CST可以同时表示美国，澳大利亚，中国，古巴四个国家的标准时间。





[24时区，GMT，UTC，DST，CST时间详解](https://blog.csdn.net/Koupoo/article/details/7470184)
[国际化常用时间格式并进行格式转换](https://www.cnblogs.com/zjdxr-up/p/12518209.html)





## Java时间日期的处理类

在 Java 中获取当前时间，可以使用 java.util.Date 类和 java.util.Calendar 类完成。其中，Date 类主要封装了系统的日期和时间的信息，Calendar 类则会根据系统的日历来解释 Date 对象。


### Date类

Date 类表示系统特定的时间戳，可以精确到毫秒。Date 对象表示时间的默认顺序是星期、月、日、小时、分、秒、年。

Date 类有如下两个构造方法。
- Date()：此种形式表示分配 Date 对象并初始化此对象，以表示分配它的时间（精确到毫秒），使用该构造方法创建的对象可以获取本地的当前时间。
- Date(long date)：此种形式表示从 GMT 时间（格林尼治时间）1970 年 1 月 1 日 0 时 0 分 0 秒开始经过参数 date 指定的毫秒数。


### Calendar类

Calendar 类是一个抽象类，它为特定瞬间与 YEAR、MONTH、DAY_OF—MONTH、HOUR 等日历字段之间的转换提供了一些方法，并为操作日历字段（如获得下星期的日期） 提供了一些方法。

创建 Calendar 对象不能使用 new 关键字，因为 Calendar 类是一个抽象类，但是它提供了一个 getInstance() 方法来获得 Calendar类的对象。getInstance() 方法返回一个 Calendar 对象，其日历字段已由当前日期和时间初始化。

Calendar 对象可以调用 set() 方法将日历翻到任何一个时间，当参数 year 取负数时表示公元前。Calendar 对象调用 get() 方法可以获取有关年、月、日等时间信息，参数 field 的有效值由 Calendar 静态常量指定。

Calendar 类中定义了许多常量，分别表示不同的意义。
- Calendar.YEAR：年份。
- Calendar.MONTH：月份。
- Calendar.DATE：日期。
- Calendar.DAY_OF_MONTH：日期，和上面的字段意义完全相同。
- Calendar.HOUR：12小时制的小时。
- Calendar.HOUR_OF_DAY：24 小时制的小时。
- Calendar.MINUTE：分钟。
- Calendar.SECOND：秒。
- Calendar.DAY_OF_WEEK：星期几。




## Java日期格式化类

DateFormat 是日期/时间格式化子类的抽象类，它以与语言无关的方式格式化并解析日期或时间。

日期/时间格式化子类（如 SimpleDateFormat）允许进行格式化（也就是日期→文本）、解析（文本→日期）和标准化日期。



### DateFormat类

抽象类

在创建 DateFormat 对象时不能使用 new 关键字，而应该使用 DateFormat 类中的静态方法 getDateInstance()


### SimpleDateFormat类

SimpleDateFormat 是一个以与语言环境有关的方式来格式化和解析日期的具体类，它允许进行格式化（日期→文本）、解析（文本→日期）和规范化。SimpleDateFormat 使得可以选择任何用户定义的日期/时间格式的模式。


SimpleDateFormat 类主要有如下 3 种构造方法。
- SimpleDateFormat()：用默认的格式和默认的语言环境构造 SimpleDateFormat。
- SimpleDateFormat(String pattern)：用指定的格式和默认的语言环境构造 SimpleDateF ormat。
- SimpleDateFormat(String pattern,Locale locale)：用指定的格式和指定的语言环境构造 SimpleDateF ormat。



日期和时间格式由 日期和时间模式字符串 指定。在 日期和时间模式字符串 中，未加引号的字母 'A' 到 'Z' 和 'a' 到 'z' 被解释为模式字母，用来表示日期或时间字符串元素。文本可以使用单引号 (') 引起来，以免进行解释。所有其他字符均不解释；只是在格式化时将它们简单复制到输出字符串

白话文的讲：这些A——Z，a——z这些字母(不被单引号包围的)会被特殊处理替换为对应的日期时间，其他的字符串还是原样输出。


日期和时间模式(注意大小写，代表的含义是不同的)
```shell
yyyy：年
MM：月
dd：日
hh：1~12小时制(1-12)
HH：24小时制(0-23)
mm：分
ss：秒
S：毫秒
E：星期几
D：一年中的第几天
F：一月中的第几个星期(会把这个月总共过的天数除以7)
w：一年中的第几个星期
W：一月中的第几星期(会根据实际情况来算)
a：上下午标识
k：和HH差不多，表示一天24小时制(1-24)。
K：和hh差不多，表示一天12小时制(0-11)。

```



| 字母 | 含义                                                         | 示例                                                         |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| y    | 年份。一般用 yy 表示两位年份，yyyy 表示 4 位年份             | 使用 yy 表示的年扮，如 11； 使用 yyyy 表示的年份，如 2011    |
| M    | 月份。一般用 MM 表示月份，如果使用 MMM，则会 根据语言环境显示不同语言的月份 | 使用 MM 表示的月份，如 05； 使用 MMM 表示月份，在 Locale.CHINA 语言环境下，如“十月”；在 Locale.US 语言环境下，如 Oct |
| d    | 月份中的天数。一般用 dd 表示天数                             | 使用 dd 表示的天数，如 10                                    |
| D    | 年份中的天数。表示当天是当年的第几天， 用 D 表示             | 使用 D 表示的年份中的天数，如 295                            |
| E    | 星期几。用 E 表示，会根据语言环境的不同， 显示不 同语言的星期几 | 使用 E 表示星期几，在 Locale.CHINA 语 言环境下，如“星期四”；在 Locale.US 语 言环境下，如 Thu |
| H    | 一天中的小时数（0~23)。一般用 HH 表示小时数                  | 使用 HH 表示的小时数，如 18                                  |
| h    | 一天中的小时数（1~12)。一般使用 hh 表示小时数                | 使用 hh 表示的小时数，如 10 (注意 10 有 可能是 10 点，也可能是 22 点） |
| m    | 分钟数。一般使用 mm 表示分钟数                               | 使用 mm 表示的分钟数，如 29                                  |
| s    | 秒数。一般使用 ss 表示秒数                                   | 使用 ss 表示的秒数，如 38                                    |
| S    | 毫秒数。一般使用 SSS 表示毫秒数                              | 使用 SSS 表示的毫秒数，如 156                                |




## 各种时间格式表示

### UTC时间格式

#### UTC第一种时间格式：2020-01-01T21:30:03+08:00，中间的T标识时间，+08:00为标识东八区时间

#### 第二种时间格式：2019-10-14T13:41:45.223Z，类似这种时间格式进行时间格式转换。 在军事中，协调世界时区会使用“Z”来表示。又由于Z在无线电联络中使用“Zulu”作代称，协调世界时也会被称为"Zulu time"。Z前面的三个数字表示毫秒。


####  yyyy-MM-dd'T'HH:mm:ss.SSSXXX和yyyy-MM-dd'T'HH:mm:ss.SSSZ区别

yyyy-MM-dd'T'HH:mm:ss.SSS'Z'

2022-02-22T15:50:18+08:00 格式化字符串是yyyy-MM-dd'T'HH:mm:ssSSSXXX

需要解析这样的日期（例如微信支付apiV3返回的交易成功日期是类似这样的：2022-02-22T15:50:18+08:00）或者需要格式化成带有时区+8:00这样的日期，可以这样做（格式化字符串是yyyy-MM-dd'T'HH:mm:ssXXX）：+08:00（或者其他时区）在解析或者格式化的时候应该使用XXX来表示;


yyyy-MM-dd'T'HH:mm:ss.SSSZ 后面的三个SSS指的是毫秒，Z代表的时区，中间的T代表可替换的任意字符。
如果是要解析或者格式化 +0800（中间没有冒号）
+0800（或者其他时区）在解析或者格式化的时候应该使用Z来表示。
yyyy-MM-dd'T'HH:mm:ssZ"


UTC第一种时间格式：2020-01-01T21:30:03+08:00，中间的T标识时间，+08:00为标识东八区时间


### GMT时间格式

#### 时间格式： Sat Oct 12 2019 14:19:40 GMT 0800 (中国标准时间)，该时间是格林尼治时间格式的时间。







GMT
BST
UTC
TZ info
时区
gmt/local
每年有一次 3600 秒的差距
闰秒
Unix 时间

。
从 UTC + 00:00 到 UTC + 07:00。
var DISPLAY_TIMEZONE = 'Europe/Helsinki'

（字符串应显示选定的 TZ，而不是 UTC）

ISO/UTC/Linuxtime 或直到最后一刻

原生的Prometheus查询指标时页面显示的指标趋势图是根据GMT时间显示的，与北京时间相差8小时，为此我们将源码中获取时间的方式修改成从本地系统时间获取。

注意：prometheus里面的时区是GMT，图形横轴显示的时间与后面的grafana显示时间不同,我们用的主机时区是CST，大家可以自己了解这个时区间的关系

Prometheus 输出时间戳始终表示为Unix时间戳，以秒为单位。其可以精确到亚秒级精度，所以其会存在小数的部分。

GMT UTC CST ISO 夏令时 时间戳，都是些什么鬼？





## ISO 8601日期格式与持续时间格式

国际标准ISO 8601，是国际标准化组织的日期和时间的表示方法，全称为《数据存储和交换形式·信息交换·日期和时间的表示方法》。目前是2004年12月1日发行的第三版“ISO8601:2004”以替代1998年的第一版“ISO8601:1998”与2000年的第二版“ISO8601:2000”。


### 一、ISO 8601日期格式



#### 1、格式

ISO 8601日期格式如下：
```
YYYY-MM-DDThh:mm:ss[.mmm]TZD
```

其中：

```
YYYY表示四位数的年份

MM表示两位数的月份

DD表示两位数的天(day of the month)，从01到31

T是用来指示时间元素的开始字符

hh表示两位数的小时，从00到23，不包括AM/PM

mm表示两位数的分钟，从00到59

ss表示两位数的秒，从00到59

mmm表示三位数的毫秒数，从000到999

TZD表示时区指示符：Z或+hh:mm或-hh:mm，+或-表示时区距离UTC(世界标准时间)时区多远。例如：

CST(中国标准时间)：UTC +08:00，EST(东部标准时间)：UTC -05:00，CST(中部标准时间)：UTC -06:00。
```


#### 2、样例

2012-03-29T10:05:45-06:00

表示：中部标准时间2012年3月29日10:05:45。

### 二、ISO 8601持续时间格式

#### 1、格式

ISO 8601持续时间格式如下：

```
P(n)Y(n)M(n)DT(n)H(n)M(n)S

```

其中：

```
P是持续时间指示符，始终放置在持续时间的开头位置

T是表示时间元素开始的指示符

(n)为时间值


```



| 符号 | 含义 |
| :--- | :--- |
| Y    | 年   |
| M    | 月   |
| D    | 日   |
| W    | 星期 |
| H    | 时   |
| M    | 分   |
| S    | 秒   |



#### 2、样例

```
P3Y8M5DT12H30M6S
```

表示的持续时间为：三年八个月五天，十二小时三十分钟六秒。





参考

[ISO 8601日期格式与持续时间格式](http://www.albertbamboo.cn/knowledge/technology/2021/04/03/iso-8601-duration-format.html)

[ISO 8601 维基百科](https://zh.m.wikipedia.org/zh-hans/ISO_8601)



